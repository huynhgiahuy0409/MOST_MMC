<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="validationCode">
	
	
	<select id="selectValidation" parameterType="validationCodeParm" resultType="validationCodeItem">
			<if test="tyCd == 'SUCCESS_TEST'">
				SELECT
				       'Y' AS isValidated
				  FROM DUAL
				 WHERE 1=1
			</if>
			<if test="tyCd == 'FAIL_TEST'">
				SELECT
				       'N' AS isValidated
				  FROM DUAL
				 WHERE 1=1
			</if>
			<if test='tyCd == "deployStaffRoleCheck"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_ROLE
				 WHERE EMP_ID  = #{col1}
				   AND ROLE_CD = #{col2}
			</if>
			<if test='tyCd == "validationSN"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
                  FROM TMT_SHIPG_NOTE
                 WHERE 
                 		SHIPG_NOTE_NO = #{col2}
                 	<if test="col1 != null and col1 != ''">
						AND VSL_CALL_ID =#{col1}
					</if>
			</if>
			<if test='tyCd == "checkSNEmptyGR"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated
				  FROM TMT_SHIPG_NOTE SN
				       INNER JOIN TMT_GR GR
				          ON     SN.VSL_CALL_ID = GR.VSL_CALL_ID
				             AND SN.SHIPG_NOTE_NO = GR.SHIPG_NOTE_NO
                 WHERE 
               			SN.SHIPG_NOTE_NO = #{col1}
			</if>
			<if test='tyCd == "checkSNTruckAssign"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated
                  FROM TMT_SHIPG_NOTE SN
                       INNER JOIN TMT_ASSIGN_TRANSPORT AG
                          ON     SN.VSL_CALL_ID = AG.VSL_CALL_ID
                             AND SN.SHIPG_NOTE_NO = AG.SHIPG_NOTE_NO
                 WHERE 
               			SN.SHIPG_NOTE_NO = #{col1}
			</if>
			<if test='tyCd == "vesselAtbEditable"'>
                SELECT
                    CASE 
                    WHEN TO_CHAR(MAX(A.ATB), 'DD/MM/YYYY HH24:MI') = #{col2} THEN 'Y'
                    WHEN MAX(A.ATU) IS NULL THEN 'Y'
                    WHEN MAX(A.ATW) IS NULL AND MAX(A.ATC) IS NULL THEN 'Y'
                    WHEN MAX(B.VSL_CALL_ID) IS NULL AND MAX(C.VSL_CALL_ID) IS NULL THEN 'Y'
                    ELSE 'N'
                    END isValidated
                FROM TMT_VSL_SCH A, TMT_VSL_SHFT B, TMT_DBL_BNK C
                WHERE A.VSL_CALL_ID = #{col1}
                    AND A.VSL_CALL_ID = B.VSL_CALL_ID (+)
                    AND A.VSL_CALL_ID = C.VSL_CALL_ID (+)
                GROUP BY A.VSL_CALL_ID
			</if>
			<if test="tyCd == 'VALID_PTNR'">
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
				  FROM TMT_PTNR PTNR,
<!-- 				  	   TB_PTNR_SYS SYS, -->
					   TMT_AGENCY_INFO AGNT
				  WHERE  
<!-- 				  		SYS.PTNR_CODE  =  PTNR.PTNR_CODE(+) -->
<!-- 					  AND  SYS.PTNR_CODE =  AGNT.AGENCY_CODE(+) -->
<!-- 		    	      AND SYS.SYSTEM_CODE = 'MPTS' -->
		    	      AND (  PTNR.PTNR_CODE = #{col1}  OR AGNT.AGENCY_CODE = #{col1})
			</if>
			<if test='tyCd == "atbExist"'>
				SELECT 
					NVL2(ATB, 'Y', 'N') AS isValidated
				FROM TMT_VSL_SCH
				WHERE VSL_CALL_ID = #{col1}
			</if>
			<if test='tyCd == "dptExist"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
				  FROM TMT_VSL_OPE_RPT_DTL
				  WHERE VSL_CALL_ID = #{col1}
				  AND DPT_AGENT is not null and UPD_DT <![CDATA[ < ]]>  SYSDATE
			</if>
			<if test='tyCd == "validateWorkDate"'>
				  SELECT  DECODE(COUNT(*), 0, 'Y', 'N') AS isValidated 
                  FROM TMT_DEPY
                WHERE EMP_ID = #{col1}
                AND WORK_YMD = TO_CHAR(TO_DATE(#{col2}, 'DD/MM/YYYY'), 'YYYYMMDD')
			    AND WORK_CD = 'WD'
			    AND ROWNUM = 1
                  AND SHFT_ID <![CDATA[ <> ]]> #{col3}
                group by work_cd,vsl_call_id,work_ymd,shft_id,emp_id
			</if>
			<if test='tyCd == "isValidWorkingTime"'>
				SELECT 
					F_CHK_WORKING_TIME(#{col1}, #{col2}) AS isValidated
				FROM DUAL				
			</if>
			<if test='tyCd == "dblBnkValid"'>
				<!-- If there is Double Banking info later than this, can't delete. ( Including mother vessel and 2nd vessel ).  -->
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED
				FROM TMT_DBL_BNK
				WHERE (VSL_CALL_ID = #{col1} AND ATB > TO_DATE(#{col2}, 'DD/MM/YYYY HH24:MI'))
				OR (DBL_BNK_SHIP1 = #{col1} AND SHIP1_ATB > TO_DATE(#{col2}, 'DD/MM/YYYY HH24:MI'))
			</if>
			<if test='tyCd == "laterEQValid"'>
				<!-- If there is Equipment Setting info after ATB of Shifting, cant' delete. -->
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED
				FROM TMT_VSL_OPE_RPT_DTL
				WHERE VSL_CALL_ID = #{col1}
				AND (WORK_ST_DT > TO_DATE(#{col2}, 'DD/MM/YYYY HH24:MI') OR WORK_END_DT > TO_DATE(#{col2}, 'DD/MM/YYYY HH24:MI'))
			</if>
			<if test='tyCd == "stsValid"'>
				<!-- If there is STS info, can't delete. -->
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED
				FROM TMT_STS
				WHERE VSL_CALL_ID = #{col1}
			</if>
			<if test='tyCd == "shftValid"'>
				<!-- If there is Shifting info later than this, can't delete. -->
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED
				FROM TMT_VSL_SHFT
				WHERE VSL_CALL_ID = #{col1}
				AND ATB_DT > TO_DATE(#{col2}, 'DD/MM/YYYY HH24:MI')			
			</if>

			<if test='tyCd == "dgConfirmedCmdt"'>
				<!-- checking dg confirmed commodity in vor liquid -->
                SELECT DECODE(A.SEQ, NULL, 'Y', 'N') AS ISVALIDATED
                FROM TMT_DG A, TMT_VSL_SCH B, TMT_CONFM_SLP_DTL C
                WHERE C.VSL_CALL_ID = #{col1}
                    AND C.VSL_CALL_ID = B.VSL_CALL_ID
                    AND C.DG_SEQ = A.SEQ (+)
                    AND C.CMDT_CD = #{col2}
                    AND C.CG_OPT_TP_CD = #{col3}
                    AND C.CG_TP_CD = #{col4}
					<if test="col5 != null and col5 != ''">
     AND
						C.TMNL_OPR = #{col5}
					</if>
			</if>
			<!-- checking conditon in Package Tariff Rate Detail -->
			<if test='tyCd == "checkConditon"'>
				SELECT DECODE(COUNT(B.PKG_NM), 0, 'N', 'Y') AS ISVALIDATED
				FROM  TMT_B_TRF b , TMT_B_TRF_CD a, TMT_B_AGRE_COND c, TMT_B_AGRE_COND_PRPT d,
           		 (select (CASE WHEN (count(x.AGRE_NO) = 6) THEN x.AGRE_NO ELSE 'N' END) as AGRE_NO from  TMT_B_AGRE_COND x 
              where  NOT ((x.PRPT_CD != #{col6} OR  x.CHR_VAL != #{col7}) AND
               (x.PRPT_CD != #{col8} OR  x.CHR_VAL != #{col9}) AND 
                 (x.PRPT_CD != #{col10} OR  x.CHR_VAL != #{col11})AND
                 (x.PRPT_CD != #{col12} OR  x.CHR_VAL != #{col13}) AND 
              (NOT (x.PRPT_CD = #{col14} AND  x.TIER_VAL1 = #{col15} AND x.TIER_VAL2 = #{col16}))AND
              (NOT (x.PRPT_CD = #{col17} AND  x.TIER_VAL1 = #{col18} AND x.TIER_VAL2 = #{col19}))
                  ) group by x.AGRE_NO) y
                 where a.TRF_CD = b.TRF_CD(+) AND a.SUB_TRF_CD = b.SUB_TRF_CD(+)
                   and  b.PRC_TP_CD = 'K' AND a.VLD_YN = 'Y' AND a.SYTM_ID = 'MT'
              		and     c.AGRE_NO = d.AGRE_NO AND c.PRPT_CD = d.PRPT_CD 
				 AND  c.AGRE_NO = y.AGRE_NO 
				AND B.PKG_NM = #{col1}
				AND   B.PTNR_CD = #{col2}
				AND   B.RMK = #{col3}
				AND   B.APLY_YMD =TO_CHAR(TO_DATE(#{col4},'DD/MM/YYYY'),'YYYYMMDD')
				AND   b.EXPR_YMD =TO_CHAR(TO_DATE(#{col5},'DD/MM/YYYY'),'YYYYMMDD')  
			</if>
			<!-- checking vor liquid weather there is vor in the jpvc -->
			<if test='tyCd == "isVORLiquidSC"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS ISVALIDATED 
				FROM TMT_LQDCG_OPE
				WHERE VSL_CALL_ID = #{col1}
				    AND (SHPR = #{col2} OR CNSNE = #{col2})
			</if>
			<if test='tyCd == "checkRcDelete"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS ISVALIDATED FROM DUAL
				 WHERE #{col3} IN (
							SELECT JOB_NO FROM TMT_JOB B
							 WHERE B.JOB_GROUP = (
									SELECT GP.JOB_GROUP FROM TMT_JOB GP
									 WHERE GP.JOB_NO = (
											SELECT MAX(MX.JOB_NO) FROM TMT_JOB MX 
											 WHERE MX.VSL_CALL_ID = #{col1} 
											   AND MX.CG_NO = #{col2})))
			</if>
			<if test='tyCd == "checkMegaPayer"'>
				SELECT DECODE(US.USER_TYPE, 'E', 
							 (SELECT DECODE(COUNT(*), 0, 'N', 'Y') FROM TMT_PTNR_USER
							   WHERE USER_ID = US.USER_ID), 
							 'Y')  
					   AS ISVALIDATED 
				  FROM TMT_USER_INFO US
				 WHERE US.USER_ID = #{col1} 
			</if>
			<if test='tyCd == "checkShipgAgent"'>
				SELECT DECODE(US.USER_TYPE, 'E', 
							 DECODE((SELECT DECODE(COUNT(*), 0, 'N', 'Y') FROM TMT_PTNR_USER 
									  WHERE PTNR_TYPE IN ( 'FWD' , 'CNS' )
										AND USER_ID = US.USER_ID), 'N', 
									(SELECT DECODE(COUNT(*), 0, 'N', 'Y') FROM TMT_VSL_SCH SH
											 WHERE VSL_CALL_ID = #{col1}
											   AND EXISTS (SELECT '1' FROM TMT_AGENCY_INFO 
														  WHERE PTNR_TYPE = 'SHA' 
															AND USER_ID = US.USER_ID
															AND AGENCY_CODE = SH.ARRV_SA_ID)), 
									'Y'),
							 'Y')  
					   AS ISVALIDATED 
				  FROM TMT_USER_INFO US
				 WHERE US.USER_ID = #{col2}
			</if>
			<if test='tyCd == "checkSvcOdrExist"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED 
				  FROM TMT_SVC_ODR_CONF
				 WHERE CATEGORY1 = #{col1}
				   AND CATEGORY2 = #{col2}
				   AND CATEGORY3 = #{col3}
				 <if test="col4 != null and col4 != ''">
    			 AND SEQ &lt;&gt; #{col4}
				 </if>
			</if>
			<!-- checking jpvc if that is belong to he's company -->
			<if test='tyCd == "isAuthShaJpvc"'>
    				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS ISVALIDATED 
				  FROM TMT_VSL_SCH A, TVC_VSL_PART B
				 WHERE VSL_CALL_ID = #{col1}
                    AND A.VSL_CD = B.VSL_CD                    
                    AND B.SA_CORP_ID = #{col2}
			</if>
			<if test='tyCd == "chkGroupEmpExists"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED 
  				  FROM TMT_SHFT_GRP_EMP
				 WHERE SHFT_GRP_CD = #{col1}
			</if>
			<if test='tyCd == "checkInvoice"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED FROM TMT_B_IV WHERE VSL_CALL_ID = #{col1} AND STAT_CD ='IV'
			</if>
			<if test='tyCd == "chkAllowExisted"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED  FROM TMT_ALLOW_RATE A 
					WHERE APP_TYPE  ='INCE'
					<if test="col1 != null and col1 != ''">
     AND
				 	ROLE1 = #{col1}
					 </if>
					 <if test="col2 != null and col2 != ''">
      AND
			(
				<if test="col3 != null and col3 != ''">
				TO_DATE(ST_DATE,'DDMMYYYY') BETWEEN TO_DATE(#{col2},'DD/MM/YYYY')
					AND TO_DATE(#{col3},'DD/MM/YYYY')
				OR (TO_DATE(ED_DATE,'DDMMYYYY') BETWEEN 
										TO_DATE(#{col2},'DD/MM/YYYY') AND TO_DATE(#{col3},'DD/MM/YYYY'))
				OR (TO_DATE(#{col2},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				OR(TO_DATE(#{col3},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				</if>
				)
			</if>
			</if>
			<if test='tyCd == "chkAllowExistedFUEL"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED  FROM TMT_ALLOW_RATE A 
					WHERE APP_TYPE  ='FUEL'
					<if test="col1 != null and col1 != ''">
     AND
				 	STAFF_ID = #{col1}
					 </if>
					 <if test="col2 != null and col2 != ''">
      AND
			(
				<if test="col3 != null and col3 != ''">
				TO_DATE(ST_DATE,'DDMMYYYY') BETWEEN TO_DATE(#{col2},'DD/MM/YYYY')
					AND TO_DATE(#{col3},'DD/MM/YYYY')
				OR (TO_DATE(ED_DATE,'DDMMYYYY') BETWEEN 
										TO_DATE(#{col2},'DD/MM/YYYY') AND TO_DATE(#{col3},'DD/MM/YYYY'))
				OR (TO_DATE(#{col2},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				OR(TO_DATE(#{col3},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				</if>
				)
			</if>   
			</if>
			<if test='tyCd == "chkAllowExistedTON"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED  FROM TMT_ALLOW_RATE A 
					WHERE APP_TYPE  ='TONN'
					<if test="col1 != null and col1 != ''">
     AND
				 	STAFF_ID = #{col1}
					 </if>
					 <if test="col2 != null and col2 != ''">
      AND
			(
				<if test="col3 != null and col3 != ''">
				TO_DATE(ST_DATE,'DDMMYYYY') BETWEEN TO_DATE(#{col2},'DD/MM/YYYY')
					AND TO_DATE(#{col3},'DD/MM/YYYY')
				OR (TO_DATE(ED_DATE,'DDMMYYYY') BETWEEN 
										TO_DATE(#{col2},'DD/MM/YYYY') AND TO_DATE(#{col3},'DD/MM/YYYY'))
				OR (TO_DATE(#{col2},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				OR(TO_DATE(#{col3},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				</if>
				)
			</if>
					        
			</if>
			<if test='tyCd == "chkAllowExistedALLO"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED  FROM TMT_ALLOW_RATE A 
					WHERE APP_TYPE  ='ALRT'
					<if test="col1 != null and col1 != ''">
     AND
				 	ALLOWANCE = #{col1}
					 </if>
					 <if test="col2 != null and col2 != ''">
      AND
			(
				<if test="col3 != null and col3 != ''">
				TO_DATE(ST_DATE,'DDMMYYYY') BETWEEN TO_DATE(#{col2},'DD/MM/YYYY')
					AND TO_DATE(#{col3},'DD/MM/YYYY')
				OR (TO_DATE(ED_DATE,'DDMMYYYY') BETWEEN 
										TO_DATE(#{col2},'DD/MM/YYYY') AND TO_DATE(#{col3},'DD/MM/YYYY'))
				OR (TO_DATE(#{col2},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				OR(TO_DATE(#{col3},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				</if>
				)
			</if>
					        
			</if>
			<!-- check for multi skill -->		        
			<if test='tyCd == "chkMuskExisted"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED  FROM TMT_ALLOW_RATE A 
					WHERE APP_TYPE  ='MUSK'
					<if test="col1 != null and col1 != ''">
     AND
				 	STAFF_ID = #{col1}
					 </if>
					 <if test="col2 != null and col2 != ''">
      AND
			(
				<if test="col3 != null and col3 != ''">
				TO_DATE(ST_DATE,'DDMMYYYY') BETWEEN TO_DATE(#{col2},'DD/MM/YYYY')
					AND TO_DATE(#{col3},'DD/MM/YYYY')
				OR (TO_DATE(ED_DATE,'DDMMYYYY') BETWEEN 
										TO_DATE(#{col2},'DD/MM/YYYY') AND TO_DATE(#{col3},'DD/MM/YYYY'))
				OR (TO_DATE(#{col2},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				OR(TO_DATE(#{col3},'DD/MM/YYYY') BETWEEN TO_DATE(ST_DATE,'DDMMYYYY')
														AND TO_DATE(ED_DATE,'DDMMYYYY'))
				</if>
				)
			</if>
			</if>
			<if test='tyCd == "checkUserRole"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_USER_AUTH
				WHERE AUTH_GRP = 'GCD325' 
					AND USER_ID = #{col1}
			</if>
			<if test='tyCd == "checkUserRoleCS"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_USER_AUTH
				WHERE AUTH_GRP = 'GCD317' 
					AND USER_ID = #{col1}
			</if>
			<if test='tyCd == "checkUserJpl"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_USER_AUTH
				WHERE AUTH_GRP = 'GCD347' 
					AND USER_ID = #{col1}
			</if>
			<if test='tyCd == "checkAdminBilling"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_USER_AUTH
				WHERE AUTH_GRP IN ( 'GCD338' ,'GCD336')
					AND USER_ID = #{col1}
			</if>
			<if test='tyCd == "checkStatus"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_DEPY
				WHERE EMP_ID = #{col1}
				AND SHFT_ID = #{col2}
			    AND WORK_YMD = TO_CHAR(TO_DATE(#{col3}, 'DD/MM/YYYY'), 'YYYYMMDD')
			    AND WORK_CD = #{col4}
			</if>
			<if test='tyCd == "checkExisted"'>
				SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED   FROM TMT_DLY_BRK 
				WHERE rownum = 1
				<if test="col1 != null and col1 != ''">
    AND
				 	VSL_CALL_ID = #{col1}
				 </if>
				<if test="col11 != null and col11 != ''">
    AND
				 	seq != #{col11}
				 </if>
				 <if test="col2 != null and col2 != ''">
     AND
					INPT_DT = TO_DATE(#{col2},'DD/MM/YYYY') 
				 </if>
				 <if test="col3 != null and col3 != ''">
     AND
				 	shft_id  = #{col3}
				 </if>
				 <if test="col4 != null and col4 != ''">
     AND
				 	RSN_CD   = #{col4}
				 </if>
				 <if test="col5 != null and col5 != ''">
     AND
				 	EQ_NO    = #{col5}
				 </if>
				 <if test="col6 != null and col6 != ''">
     AND
				 	HATCH_NO     = #{col6}
				 </if>
				 <if test="col7 != null and col7 != ''">
     AND
				 	ACPT_YN      = #{col7}
				 </if>
				  <if test="col8 != null and col8 != ''">
      AND
				 	HATCH_DRT_CD       = #{col8}
				 </if>
				  <if test="col9 != null and col9 != ''">
      AND
				  (
				  	<if test="col10 != null and col10 != ''">
				ST_DT BETWEEN TO_DATE(#{col9},'DD/MM/YYYY HH24:MI')
					AND TO_DATE(#{col10},'DD/MM/YYYY HH24:MI')
				OR END_DT BETWEEN TO_DATE(#{col9},'DD/MM/YYYY HH24:MI') AND TO_DATE(#{col10},'DD/MM/YYYY HH24:MI')
				OR (TO_DATE(#{col9},'DD/MM/YYYY HH24:MI') BETWEEN  ST_DT
														AND END_DT)
				OR(TO_DATE(#{col10},'DD/MM/YYYY HH24:MI') BETWEEN ST_DT
														AND END_DT)
					</if>
					<if test="col10 == null or col10 == ''">
					END_DT <![CDATA[>]]> TO_DATE(#{col9},'DD/MM/YYYY HH24:MI')
					</if>
				  )
				  </if>
				  
				  <if test="col12 != null and col12 != ''">
				  AND
				  (
							ST_DT <![CDATA[<]]> TO_DATE(#{col12},'DD/MM/YYYY HH24:MI') 
                        AND	END_DT <![CDATA[>]]> TO_DATE(#{col12},'DD/MM/YYYY HH24:MI')
                        
                        <if test="col13 != null and col13 != ''">
						OR
						(
							ST_DT <![CDATA[<]]> TO_DATE(#{col13},'DD/MM/YYYY HH24:MI') 
						AND END_DT <![CDATA[>=]]> TO_DATE(#{col13},'DD/MM/YYYY HH24:MI')
						)
                        </if>
                   ) 
				  </if>
			</if>
			
			<!-- Added by Joseph - 46046 -->
			<if test='tyCd == "checkCNS"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
			    FROM TB_PTNR PTNR, TB_PTNR_SYS SYS
			   WHERE     PTNR.PTNR_CODE = SYS.PTNR_CODE
			         AND SYS.SYSTEM_CODE = 'MPTS'
			         AND PTNR_TYPE = 'CNS'
			         AND PTNR.PTNR_CODE LIKE #{col1}
			</if>
			
			<if test='tyCd == "checkCTT"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
			    FROM TB_PTNR PTNR, TB_PTNR_SYS SYS
			   WHERE     PTNR.PTNR_CODE = SYS.PTNR_CODE
			         AND SYS.SYSTEM_CODE = 'MPTS'
			         AND PTNR_TYPE = 'CTT'
			         AND PTNR.PTNR_CODE LIKE #{col1}
			</if>
			
			<if test='tyCd == "checkFWD"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
			    FROM TB_PTNR PTNR, TB_PTNR_SYS SYS, TB_AGENCY_INFO AGNT
			   WHERE     SYS.PTNR_CODE = PTNR.PTNR_CODE(+)
			   		 AND SYS.PTNR_CODE = AGNT.AGENCY_CODE(+)
                     <!-- AND SYS.SYSTEM_CODE = 'MPTS'  -->
			         AND (PTNR.PTNR_CODE LIKE #{col1} OR AGNT.AGENCY_CODE = #{col1})
			</if>
			
			<if test='tyCd == "checkCTTForHHT"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
			    FROM TB_PTNR PTNR, TB_PTNR_SYS SYS
			   WHERE     PTNR.PTNR_CODE = SYS.PTNR_CODE
			         AND SYS.SYSTEM_CODE = 'MPTS'
			         AND PTNR_TYPE = 'CTT'
			         AND PTNR.PTNR_CODE = #{col1}
			</if>
			
			<if test='tyCd == "checkFWDForHHT"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated
			    FROM TB_PTNR PTNR, TB_PTNR_SYS SYS, TB_AGENCY_INFO AGNT
			   WHERE     SYS.PTNR_CODE = PTNR.PTNR_CODE(+)
			   		 AND SYS.PTNR_CODE = AGNT.AGENCY_CODE(+)
                     AND SYS.SYSTEM_CODE = 'MPTS' 
                      AND PTNR.PTNR_TYPE IN ('FWD', 'SHA','CNS','CTT','TMO')
			         AND (PTNR.PTNR_CODE = #{col1} OR AGNT.AGENCY_CODE = #{col1})
			</if>
			
			<if test='tyCd == "IMDG"'>
				SELECT 
       				DECODE (UNNO, null, 'N', 'Y')  AS isValidated
  				FROM TMT_CMDT
 				WHERE CMDT_CD LIKE #{col1}
			</if>
			<if test='tyCd == "validationFinalCargo"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated,F_GET_CARGO_STAT(#{col1},#{col2}) ref5
				  FROM TMT_JOB
				 WHERE     VSL_CALL_ID = #{col1}
				       AND FNL_OPE_YN = 'Y'
				       AND JOB_TP_CD ='LD' AND JOB_PURP_CD IN ('AV', 'GV')
				       AND CG_NO IN (SELECT GR_NO
				                       FROM TMT_GR
				                      WHERE SHIPG_NOTE_NO = #{col2})
			</if>
			<if test='tyCd == "validationFinalRORO"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated,F_GET_CARGO_STAT(#{col1},#{col2}) ref5
				  FROM TMT_JOB
				 WHERE     VSL_CALL_ID = #{col1}
				       AND JOB_TP_CD ='LD' AND JOB_PURP_CD IN ('AV', 'GV')
				       AND CG_NO IN (SELECT SHIPG_NOTE_NO
				                       FROM TMT_GR
				                      WHERE SHIPG_NOTE_NO = #{col2})
			</if>
			<if test='tyCd == "validationFinalCargo4HandlingIn"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated
				  FROM TMT_CG_MST
				 WHERE     VSL_CALL_ID = #{col1}
				       AND cg_no  IN (SELECT GR_NO
				                       FROM TMT_GR
				                      WHERE SHIPG_NOTE_NO = #{col2})
				       AND HDL_IN_END_DT IS NOT NULL
			</if>
			<if test='tyCd == "validationFinalUpdate4Wh"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated
				  FROM TMT_CG_MST
				 WHERE     VSL_CALL_ID = #{col1}
				       AND cg_no  IN (SELECT GR_NO
				                       FROM TMT_GR
				                      WHERE SHIPG_NOTE_NO = #{col2})
				       AND HDL_IN_END_DT IS NOT NULL
			</if>
			<if test='tyCd == "validationFinalUpdate4Loading"'>
				SELECT DECODE (COUNT (*), 0, 'Y', 'N') AS isValidated
				  FROM TMT_JOB
				 WHERE     VSL_CALL_ID = #{col1}
				       AND FNL_OPE_YN = 'Y'
				       AND JOB_TP_CD ='LD'
				       AND CG_NO IN (SELECT GR_NO
				                       FROM TMT_GR
				                      WHERE SHIPG_NOTE_NO = #{col2})
			</if>
			<if test='tyCd == "createCS1"'>
					<if test="col1 != null and col1 != ''">
						<if test='col2 == "CTR"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "DBE"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "DBN"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "BBK"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "LQE"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "LQN"'>
						SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "OIMR"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "BT"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
					</if>
			</if>
			<if test='tyCd == "createDocument"'>
					<if test="col1 != null and col1 != ''">
						<if test='col2 == "CTR"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "DBE"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "DBN"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "BBK"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "LQE"'>
						SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "LQN"'>
						SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "OIMR"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
						<if test='col2 == "BT"'>
							SELECT CASE
          WHEN (ETA - SYSDATE) > 0
          THEN
             CASE
                WHEN (ETA - SYSDATE) <![CDATA[>=]]>
                        (  NVL (
                              (SELECT KEY_VAL
                                 FROM TMT_CFG_DTL
                                WHERE     SYS_CD = 'MPTS'
                                      AND KEY_NM = #{col2}
                                      AND ROWNUM = 1),
                              0)
                         / 24)
                THEN
                   'Y'
                ELSE
                   'N'
             END
          ELSE
             CASE
                WHEN (SELECT KEY_VAL
                        FROM TMT_CFG_DTL
                       WHERE     SYS_CD = 'MPTS'
                             AND KEY_NM = #{col2}
                             AND ROWNUM = 1) = 0
                THEN
                   'Y'
                ELSE
                   'N'
                 END
             END                              AS isValidated
                      FROM TMT_VSL_SCH WHERE VSL_CALL_ID = #{col1}
						</if>
					</if>
			</if>
			<if test='tyCd == "submitLateVesselSchedule"'>
				SELECT DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
				  FROM TMT_VSL_SCH
				WHERE VSL_CALL_ID  = #{col1}
			 	 AND first_eta -  INS_DTM <![CDATA[<]]>  7
			</if>
			<!-- Add for Tablet -->
			<if test='tyCd == "existsVslDelay"'>
				SELECT
					(
					SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED   FROM TMT_DLY_BRK 
						WHERE rownum = 1
						<if test="col1 != null and col1 != ''">
							AND VSL_CALL_ID = #{col1}
						</if>
						<if test="col2 != null and col2 != ''">
							AND INPT_DT = TO_DATE(#{col2},'DD/MM/YYYY') 
						</if>
						<if test="col3 != null and col3 != ''">
							AND shft_id  = #{col3}
						</if>
						<if test="col4 != null and col4 != ''">
							AND RSN_CD   = #{col4}
						</if>
						<if test="col5 != null and col5 != ''">
							AND EQ_NO    = #{col5}
						</if>
						<if test="col6 != null and col6 != ''">
							AND HATCH_NO     = #{col6}
						</if>
						<if test="col7 != null and col7 != ''">
							AND ACPT_YN      = #{col7}
						</if>
						<if test="col8 != null and col8 != ''">
							AND HATCH_DRT_CD       = #{col8}
						</if>
						<if test="col9 != null and col9 != ''">
							AND
							(
								<if test="col10 != null and col10 != ''">
									ST_DT BETWEEN TO_DATE(#{col9},'DD/MM/YYYY HH24:MI')
									AND TO_DATE(#{col10},'DD/MM/YYYY HH24:MI')
									OR END_DT BETWEEN TO_DATE(#{col9},'DD/MM/YYYY HH24:MI') AND TO_DATE(#{col10},'DD/MM/YYYY HH24:MI')
									OR (TO_DATE(#{col9},'DD/MM/YYYY HH24:MI') BETWEEN  ST_DT
									AND END_DT)
									OR(TO_DATE(#{col10},'DD/MM/YYYY HH24:MI') BETWEEN ST_DT
									AND END_DT)
								</if>
								<if test="col10 == null or col10 == ''">
									END_DT <![CDATA[>]]> TO_DATE(#{col9},'DD/MM/YYYY HH24:MI')
								</if>
							)
						</if>
						<if test="col11 != null and col11 != ''">
					 		AND SEQ <![CDATA[<>]]> #{col11}
					 	</if>
						) AS ISVALIDATED,
					(SELECT DLY_CD FROM TMT_DLY_CD 
					 WHERE ROWNUM = 1 AND DLY_CD = #{col4}) AS ref1
				FROM DUAL
		</if>
		<if test='tyCd == "existsJettyDelay"'>
				SELECT
					(
					SELECT DECODE(COUNT(*), 0, 'Y', 'N') AS ISVALIDATED   FROM TMT_DLY_SUM 
						WHERE rownum = 1
						<if test="col1 != null and col1 != ''">
							AND VSL_CALL_ID = #{col1}
						</if>
						<if test="col2 != null and col2 != ''">
							AND CG_TP_CD = #{col2}
						</if>
						<if test="col3 != null and col3 != ''">
							AND DLY_CD  = #{col3}
						</if>
						<if test="col4 != null and col4 != ''">
							AND WORK_YMD = TO_CHAR(TO_DATE(#{col4}, 'DD/MM/YYYY'), 'YYYYMMDD')
						</if>
						<if test="col5 != null and col5 != ''">
							AND SHFT_ID    = #{col5}
						</if>
						<if test="col6 != null and col6 != ''">
							AND
							(
								<if test="col7 != null and col7 != ''">
									ST_DT BETWEEN TO_DATE(#{col6},'DD/MM/YYYY HH24:MI')
									AND TO_DATE(#{col7},'DD/MM/YYYY HH24:MI')
									OR END_DT BETWEEN TO_DATE(#{col6},'DD/MM/YYYY HH24:MI') AND TO_DATE(#{col7},'DD/MM/YYYY HH24:MI')
									OR (TO_DATE(#{col6},'DD/MM/YYYY HH24:MI') BETWEEN  ST_DT
									AND END_DT)
									OR(TO_DATE(#{col7},'DD/MM/YYYY HH24:MI') BETWEEN ST_DT
									AND END_DT)
								</if>
								<if test="col7 == null or col7 == ''">
									END_DT <![CDATA[>]]> TO_DATE(#{col6},'DD/MM/YYYY HH24:MI')
								</if>
							)
						</if>
						<if test="col8 != null and col8 != ''">
					 		AND SEQ <![CDATA[<>]]> #{col8}
					 	</if>
						) AS ISVALIDATED,
					(SELECT DLY_CD FROM TMT_DLY_CD 
					 WHERE ROWNUM = 1 AND DLY_CD = #{col3}) AS ref1
				FROM DUAL
		</if>
								
		
		<if test='tyCd == "deleteAllIvAdviceStatusValidation"'>
			SELECT 	DECODE(COUNT(*),0,'Y','N') AS isValidated
			  FROM 	TMT_B_IV_ADV_ACK AC
			       	INNER JOIN TMT_B_IV_ADV AV ON AV.ADV_NO = AC.ADV_NO
			 WHERE 	AV.VSL_CALL_ID = #{col1}
			 		AND ACK_STAT_CD = 'C'
		</if>	
		
		<if test='tyCd == "BERTH_OVERLAP_VALIDATION"'>
			SELECT  CASE WHEN COUNT(VSL_CALL_ID) = 0 THEN 'Y' ELSE 'N' END AS isValidated
			FROM    TMT_VSL_SCH S
			WHERE   ATB IS NOT NULL
			        AND ATU IS NULL
			        AND BERTH_LOC = #{col1}
			        AND VSL_CALL_ID != #{col2}
		</if>
		
		<if test='tyCd == "ISEXISTED_APPROVAL_CRANE_MEGA"'>
			SELECT CASE WHEN COUNT (1) > 0 THEN 'Y' ELSE 'N' END AS isValidated
			  FROM TMT_MEGA A
			       INNER JOIN TMT_MEGA_DTL B ON A.MEGA_NO = B.MEGA_NO
			       LEFT OUTER JOIN TMT_MEGA_DTL_OPE C
			          ON     B.MEGA_NO = C.MEGA_NO
			             AND B.SEQ = C.MEGA_IDX
			             AND B.EQ_DIV_CD = C.EQ_DIV_CD
			 WHERE     A.STAT_CD = 'AP'
			       AND (A.MEGA_TP_CD IS NULL OR A.MEGA_TP_CD &lt;&gt; 'H')
			       AND A.VSL_CALL_ID = #{col1}
			       AND A.PURP_TP_CD = #{col2}  
			       AND A.SHFT_ID = #{col3}
			       AND A.WORK_YMD =
			              TO_CHAR (TO_DATE (#{col4}, 'DD/MM/YYYY'), 'YYYYMMDD')
			       AND B.DIV_CD = 'EQ'
			       AND B.EQ_DIV_CD = 'SC'
<!-- 			       AND (   EXISTS -->
<!-- 			                  (SELECT S_CD -->
<!-- 			                     FROM TMT_CD_MSTD -->
<!-- 			                    WHERE     L_CD = 'MT' -->
<!-- 			                          AND M_CD = 'EQFCTPCD' -->
<!-- 			                          AND S_CD = B.EQ_DIV_CD -->
<!-- 			                          AND S_CD_VAL = 'PC') -->
<!-- 			            OR  -->
<!-- 			            B.EQ_DIV_CD = 'SC') -->
		</if>	
		
		<if test='tyCd == "EXISTED_ACCOUNTNO_PTNR_VALIDATION"'>
			WITH PTNR_INFO AS
			(
			    SELECT  PTNR_CODE, ACC_NO
			    FROM    TMT_PTNR
			    WHERE   PTNR_CODE = #{col1}
			            AND ACC_NO IS NOT NULL
			    UNION
			    SELECT  AGENCY_CODE PTNR_CODE, ACC_NO
			    FROM    TMT_AGENCY_INFO
			    WHERE   AGENCY_CODE = #{col1}
			            AND ACC_NO IS NOT NULL
			)
			SELECT  CASE WHEN COUNT(1) > 0 THEN 'Y' ELSE 'N' END AS isValidated
			FROM    PTNR_INFO
		</if>	
		
		<if test="tyCd== 'CHECK_DUPLICATED_SN_FOR_RHDL'">
			SELECT 	CASE WHEN COUNT (*) > 0 THEN 'N' ELSE 'Y' END AS isValidated
			FROM	TMT_RHDL_CG 
			WHERE	NX_VSL_CALL_ID = #{col1}
					AND NX_REF_NO = #{col2}
		</if>
		
		<if test="tyCd== 'RORO_OP_CHECK'">
			SELECT  CASE WHEN COUNT(*) = 0 THEN 'N' ELSE 'Y' END  AS isValidated
                FROM    TMT_VSL_OPE_RPT_DTL
                WHERE   VSL_CALL_ID = #{col1}
                        AND CG_TP_CD = #{col2}
                        AND WORK_ST_DT &lt; TO_DATE(#{col3}, 'DD/MM/YYYY HH24:MI')
                        AND WORK_END_DT &gt; TO_DATE(#{col3}, 'DD/MM/YYYY HH24:MI')
                        AND SHFT_ID = F_GET_SHIFT_CD (TO_DATE(#{col3}, 'DD/MM/YYYY HH24:MI'))
		</if>
		<if test="tyCd== 'COSTCENTER_EXISTED_CHECK'">
			SELECT  CASE WHEN COUNT(*) = 0 THEN 'N' ELSE 'Y' END  AS isValidated
                FROM    TMT_B_COSTCENT
                WHERE   COST_CENT_CD = #{col1}
                        AND ERP_COST_CENT = #{col2}
		</if>
		
		<if test="tyCd== 'BONDED_WH_VALIDATION'">
			SELECT  DECODE (COUNT (*), 0, 'N', 'Y') AS isValidated
			FROM    TMT_CUSTOMS_RELEASE
			WHERE   VSL_CALL_ID = #{col1}
			        AND DOC_NO = #{col2}
			        AND BONDED_WH_YN = 'Y'
			        <choose>
			        	<when  test="col3 eq 'I'.toString()">
			        		AND CUST_GET_IN IS NOT NULL
			        	</when>
			        	<otherwise>
			        		AND CUST_GET_OUT IS NOT NULL
			        	</otherwise>
			        </choose>
			        
		</if>
		
		<if test="tyCd== 'CUSTOMS_RELEASED_VALIDATION'">
			SELECT  DECODE (COUNT (*), 0, 'N', 'Y') AS isValidated
			FROM    TMT_CUSTOMS_RELEASE
			WHERE   VSL_CALL_ID = #{col1}
			        AND DOC_NO = #{col2}
			        AND NVL(BONDED_WH_YN, 'N') = 'N' 
		</if>
		
		<if test="tyCd=='OPE_TMNLHOLD_VALIDATION'">
			SELECT	CASE WHEN COUNT (*) = 0 THEN 'Y' ELSE 'N' END AS isValidated
		  	FROM 	TMT_TMNL_HOLD H
		       		INNER JOIN TMT_VSL_SCH V
		          		ON  H.VSL_CALL_ID = V.VSL_CALL_ID
		             		AND NVL(H.RELEASE_STATUS, 'N') = 'N'
		             		AND INSTR(H.OP_MODE, #{col3}) > 0
		 	WHERE V.VSL_CALL_ID = #{col1} AND H.CG_NO = #{col2}
		</if>
		
		<if test="tyCd=='OPE_BILL_DOCUMENT_HOLD_VALIDATION'">
			SELECT	CASE WHEN COUNT (*) = 0 THEN 'Y' ELSE 'N' END AS isValidated
		  	FROM 	TMT_TMNL_HOLD H
		       		INNER JOIN TMT_VSL_SCH V
		          		ON  H.VSL_CALL_ID = V.VSL_CALL_ID
		             		AND NVL(H.RELEASE_STATUS, 'N') = 'N'
		             		AND INSTR(H.OP_MODE, #{col3}) > 0
		 	WHERE V.VSL_CALL_ID = #{col1} AND H.CG_NO = #{col2}
		</if>
		
		<if test="tyCd=='2ND_WEIGHTED_VALIDATION'">
			SELECT  DECODE(COUNT(*), 0, 'N', 'Y') AS isValidated 
			FROM    TMT_WEIGHTBRIDGE
			WHERE   SECOND_WGT IS NULL
			        AND TRANSACTION_NO = #{col1}
		</if>
		
		<if test="tyCd=='INTERNALTRUCK_APRON_OPE_VALIDATION'">
			SELECT  DECODE(COUNT(*), 0, 'Y', 'N') AS isValidated 
			FROM    TMT_JOB
			WHERE   JOB_PURP_CD IN ('VA', 'WA')
			        AND NEXT_JOB_NO IS NULL
			        AND LORRY_NO = #{col1}
		</if>
		<if test="tyCd=='UNITS_RORO_IN_STORED'">
			SELECT  CASE WHEN COUNT (*) = 0 THEN 'N' ELSE 'Y' END  AS isValidated 
            FROM    TMT_JOB
            WHERE   JOB_PURP_CD IN ('AW')
                    AND NEXT_JOB_NO IS NULL
			        AND VSL_CALL_ID = #{col1}
			        AND CG_NO = #{col2}
			        <if test="col3 != null and col3 != ''">
			        	AND CHAS_NO = #{col3} 
			        </if>
		</if>
	</select>
	
	<sql id = "selectConfirmedTruckItems">
	<!-- List of Truck In side (gate in not gate out) and already confirm Handling Out-->
		SELECT /*selectConfirmedJobTruckItems*/
		        GT.VSL_CALL_ID         	AS VSLCALLID,
		        CG_IN_OUT_CD         	AS CGINOUT,
		        GT.LORRY_NO          	AS LORRYNO,
		        GATE_TXN_NO         	AS GATETXNNO,
		        BL.BL_NO             	AS BLNO,
		        SN.SHIPG_NOTE_NO     	AS SHIPGNOTENO
		   FROM 
		           TMT_CG_ARRV_DELV GT
		        LEFT JOIN TMT_BL BL ON GT.CG_NO = BL.BL_NO AND GT.VSL_CALL_ID = BL.VSL_CALL_ID
		        LEFT JOIN TMT_GR GR ON GT.CG_NO = GR.GR_NO AND GT.VSL_CALL_ID = GT.VSL_CALL_ID
		        LEFT JOIN TMT_SHIPG_NOTE SN ON SN.SHIPG_NOTE_NO = GR.SHIPG_NOTE_NO AND SN.VSL_CALL_ID = GR.VSL_CALL_ID
		WHERE 
		        GT.GATE_OUT_DT IS NULL 
		    AND GT.GATE_CD_OUT IS NULL
		    AND GATE_TXN_NO IS NOT NULL
		    AND GT.JOB_NO IS NOT NULL
        	AND GT.VSL_CALL_ID = #{vslCallId}
        	AND	GT.LORRY_NO = #{lorryNo}
		GROUP BY 
		         GT.VSL_CALL_ID
		        ,CG_IN_OUT_CD
		        ,GT.LORRY_NO
		        ,GATE_TXN_NO
		        ,BL.BL_NO
		        ,SN.SHIPG_NOTE_NO
	</sql>
	<sql id = "selectGateInTruckItems">
		<!--ADP. CUSP: Lorry Gate In, not Gate Out yet -->
		SELECT /*selectGateInLorryItems*/
		  		    GT.VSL_CALL_ID     	AS VSLCALLID,
	                CG_NO             	AS CGNO,
	                GR.GR_NO			AS GRNO,
	                CG_IN_OUT_CD     	AS CGINOUT,
	                GT.LORRY_NO      	AS LORRYNO,
	                GATE_IN_DT     		AS GATE_IN_DT,
	                GATE_OUT_DT     	AS GATE_OUT_DT,
	                GATE_TXN_NO     	AS GATETXNNO,
	                BL.BL_NO 			AS BLNO,
	                SN.SHIPG_NOTE_NO 	AS SHIPGNOTENO
	           FROM 
	                   TMT_CG_ARRV_DELV GT
	                LEFT JOIN TMT_BL BL ON GT.CG_NO = BL.BL_NO AND GT.VSL_CALL_ID = BL.VSL_CALL_ID
	                LEFT JOIN TMT_GR GR ON GT.CG_NO = GR.GR_NO AND GT.VSL_CALL_ID = GT.VSL_CALL_ID
	                LEFT JOIN TMT_SHIPG_NOTE SN ON SN.SHIPG_NOTE_NO = GR.SHIPG_NOTE_NO AND SN.VSL_CALL_ID = GR.VSL_CALL_ID
		   WHERE 
		        	GT.GATE_OUT_DT IS NULL 
		        AND GT.GATE_CD_OUT IS NULL
		        AND GATE_PASS_NO IS NULL AND JOB_NO IS NULL
		        <if test="vslCallId != null and vslCallId != ''">
		        	AND GT.VSL_CALL_ID = #{vslCallId}
		        </if>
		        <if test="lorryNo != null and lorryNo != ''">
		        	AND	GT.LORRY_NO = #{lorryNo}
		        </if>
		        <if test="cgNo != null and cgNo != ''">
		        	AND	GT.CG_NO = #{cgNo}
		        </if>
		ORDER BY
        		GT.GATE_IN_DT DESC
	</sql>
	
</mapper>
